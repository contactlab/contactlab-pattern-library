<link rel="import" href="../../assets/bower/polymer/polymer.html">

<dom-module id="page-tables">
	<style></style>

	<template>
		<h2>Tables</h2>
		<section>
			<div class="component-description">
				Tables are used to make large volumes of data easy to understand and to access.
			</div>
			<article class="component">
				<div class="example">
					<table class="striped-table">
						<tr>
					      <th>Table Header 1</th>
					      <th>
					      	Table Header 2
					      	<i class="clab-icon icon-arrow-top sorting-arrow top active"></i>
					      	<i class="clab-icon icon-arrow-down sorting-arrow bottom"></i>
					      </th>
					      <th>Table Header 3</th>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					</table>
				</div>
				<div class="example">
					<table class="striped-table">
						<tr>
					      <th>Table Header 1</th><th>Table Header 2</th><th>Table Header 3</th>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					</table>
				</div>
				<div class="example">
					<table class="hover-table">
						<tr>
					      <th>Table Header 1</th><th>Table Header 2</th><th>Table Header 3</th>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					    <tr>
					      <td>Division 1</td><td>Division 2</td><td>Division 3</td>
					    </tr>
					</table>
				</div>

				<div class="example">
					<div class="full-table-wrapper">
						<div class="table-tools">
							<div class="entries-number">
								<span>Show </span>
								<span class="entries-select">
									<dropdown-clab id="dd-table" options='[{"value":"5","label": "5"}, {"value":"10","label": "10"}, {"value":"15","label": "15"}]' selected='{"value":"5", "label":"5"}' on-change="_setPagesAndRange"></dropdown-clab>
								</span>
								<span> entries</span>
							</div>
							<div class="table-search">
								<input-clab value="{{inputText}}" on-keyup="_search"></input-clab>
							</div>
						</div>
						<table id="full-table">
							<tr>
								<th>
									Table Header 1
									<i class="clab-icon icon-arrow-top sorting-arrow top"></i>
									<i class="clab-icon icon-arrow-down sorting-arrow bottom active"></i>
								</th>
								<th>
									Table Header 2
									<i class="clab-icon icon-arrow-top sorting-arrow top active"></i>
									<i class="clab-icon icon-arrow-down sorting-arrow bottom"></i>
								</th>
								<th>
									Table Header 3
									<i class="clab-icon icon-arrow-top sorting-arrow top"></i>
									<i class="clab-icon icon-arrow-down sorting-arrow bottom"></i>
								</th>
							</tr>
						    <template is="dom-repeat" items="[[visibleContent]]">
						    	<tr>
							      <td>[[item.row1]]</td><td>[[item.row2]]</td><td>[[item.row3]]</td>
							    </tr>
						    </template>

						</table>
						<div class="table-recap">
							<template is="dom-if" if="[[pagination]]">
								<div class="total-entries">
									[[tableEntries]]
								</div>
								<div class="pagination">
									<pagination-clab id="pages-table" pages="[[tablePages]]" on-change="_setVisibleContent"></pagination-clab>
								</div>
							</template>
						</div>
					</div>

				</div>
				<div class="specs">
					<tabs-clab  labels='["HTML"]' active="0">
							<div class="tab-content">
								<button-clab type="secondary clipboard" appearance="full" size="small" on-click="_copyToClipboard">copy to clipboard</button-clab>
								<div class="copy">
<pre><code class="html">&lt;!-- Add class striped-table or hover-table to table tag --&gt;
&lt;table&gt;
	&lt;tr&gt;
		&lt;th&gt;Table Header 1&lt;/th&gt;&lt;th&gt;Table Header 2&lt;/th&gt;&lt;th&gt;Table Header 3&lt;/th&gt;
	&lt;/tr&gt;
	&lt;tr&gt;
		&lt;td&gt;Division 1&lt;/td&gt;&lt;td&gt;Division 2&lt;/td&gt;&lt;td&gt;Division 3&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;</code></pre>
								</div>
							</div>
						</tabs-clab>
				</div>
			</article>
		</section>

	</template>

	<script>

		Polymer({
			is:'page-tables',
			behaviors: [ClipboardBehav],
			properties: {
				tableContent:{
					type:Array,
					value: function(){
						var items=[];
						for(var i=0; i<74; i++){
							var obj={
								"row1": "Division 1 of data "+(i+1),
								"row2": "Division 2 of data "+(i+1),
								"row3": "Division 3 of data "+(i+1)
							}
							items.push(obj);
						}
						return items;
					}
				},
				workableContent:{
					type:Array
				},
				visibleContent:{
					type:Array,
					value:[]
				},
				tablePages:{
					type:Array,
					value:[]
				},
				tableEntries:{
					type:String
				},
				inputText:{
					type:String
				},
				pagination:{
					type:Boolean,
					value:true
				}
			},
			ready:function(){
				// this.set('workableContent', this.tableContent);
				// this._setPagesAndRange();
			},
			attached:function(){
				this._highlightCode();
			},



			_setPagesAndRange:function(){
				var value = this.$['dd-table'].selected.value;
				var totPages = this.workableContent.length/value;

				if(this.workableContent.length<value){
					this.set('visibleContent', this.workableContent);
					this.pagination=false;
					return;
				} else {
					this.pagination=true;
				}

				var pages=[];
				for(var i=1; i<=Math.ceil(totPages); i++){
					var end=value*i;
					var start=(end-1)-(value-1);
					pages.push(start+'#'+end);
				}
				this.set('tablePages', pages);

				this.async(this._setVisibleContent, 100);
			},

			_setVisibleContent:function(){
				var str=this.$$('#pages-table').pages[this.$$('#pages-table').currentPage-1];
				var range=str.split('#');
				var visible=this.workableContent.slice( Number(range[0]), Number(range[1]) );

				this.set('visibleContent', visible);
				this.tableEntries = 'Showing '+(Number(range[0])+1)+' to '+range[1]+' of '+this.workableContent.length+' entries';
			},



			_search:function(evt){
				var str=this.inputText;
				var res=[];
				this.tableContent.map(function(obj){
					for(prop in obj){
						if(obj[prop].toLowerCase().search(str)>-1) {
							res.push(obj);
							return;
						}
					}
				});
				this.set('workableContent', res);
				this._setPagesAndRange();
			}
		});

	</script>
</dom-module>
